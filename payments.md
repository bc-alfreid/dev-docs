Here are some notes on the payments API.


PROJECT-1986.payment_api_v3_create_payments_scope is the expirement I enabled.

I keep getting an order is invalid. I made the order using the cart/checkout then created an order using the checkout api. 
I have tried serveral orders, but it keeps returning order invalid. What makes the order valid so that I can get a payment access token?

```
{
  "order": {
    "id": 183
  }
}

```

`https://api.bigcommerce.com/stores/jrah6gmn/v3/payments/access_tokens`

## PaymentAccessTokenRequest under Create an access token

Why is there an is_recurring field? Does it do anything?
Why would I want to fill in shopper_session?

## Stored Card
- Right now this looks like its read only. Is this in anticipation of vaulted cards?
- Brand - you mean like visa, mastercard
- iin where would a dev get this
- token where would they get the token

## Payment Method
- test mode: Normally (and this is just from a merchants view), you set test mode on the payment portals site. What does setting
it here do? For example is if I select test mode here, but its not selected on the payment provides end what happens?

# Process a payment for a particular order

## Card
- type is enum and then its card again. Are there more types coming? What are the other options?
- verification_value: Where is this from? Do oyu mean the cvv on the card?

## Stored Card
- type: Just says to classify this payment instrument and it is stored_card? Are there others? 

## Payment Request
- payment_method_id What identifier? It doesn't explain where that can be found


## First attempts

{
    "status": 500,
    "code": 10000,
    "title": "Something went wrong with your request, please try again",
    "type": "https://developer.bigcommerce.com/api#api-status-codes"
}


{
    "status": 422,
    "code": 20001,
    "title": "Order is invalid.",
    "type": "https://developer.bigcommerce.com/api#api-status-codes"
}

{
  "order": {
    "id": 183 //order I created via api.
  }
}




# Documentation 

The Payments API allows for an order to have a payment processed.
A payment can be taken for an order that is created using the [V2 Orders API]() or with orders created using the /orders endpoint on the[ Server to Server Checkout API]().

Payments consist of two API hosts:

To process the payment: https://payments.bigcommerce.com/stores/{store_hash}/payments

To create the payment token or get payment methods:
https://api.bigcommerce.com/stores/{store_hash}/v3/payments

## Workflow
First, a Payment Access Token must be created using the [/payments/access_tokens]() endpoint. Then that access token is sent as part of the header using the [/payments]() endpoint.

## Technical Details 

### Token
The payment_access_token is not from the payment provider. Instead, this token is generated by BigCommerce and sent to the payment provider to complete the transaction. In this way, you can also think of BigCommerce as the payment processor. 

### Decline Payments
If a payment is declined it will return a 4XX error with details if available. 

### Authorization
If a payment gateway is configured for authorization only, it will authorize the payment. The order will have to later be captured through the control panel. If the gateway is set for authorization and capture, it will authorize and capture the payment.

### Vaulted Cards
Currently, it works with cards that are currently vaulted. It does not allow for cards to be vaulted via the API.

### Control Panel
Orders created and captured via the API will look the same as other orders created via the storefront or other apps. 

### Payment Providers
This works with any payment provider BigCommerce supports. The test payment gateway can also be used if enabled on the store.

### Data Access
The card data is not accessible via the API. There are [exceptions](). 

## Braintree/ Run a credit card directly
This section will be left out. I understand from the comment Marquis left we are not supporting this at launch. If we are can I please have the steps for each process along with a sample request body.

> With current version, only payments through credit card and stored cards are supported. Braintree can support payments through credit card but so far, we have been supporting only payments through payment token.

## Limitations
Orders with more than one shipping address or consignment are not able to process payments. 


I've gotten a bit further and some more questions to clear things up: 

What providers will this work with?

> Theoretically, any provider that is in BigPay. https://intranet.bigcommerce.com/display/pta/Payment+integrations+-+Status
> However many providers do not support sending cards directly (EG. Braintree) and so the better way to use many provides is to use vaulted cards.

I wanted to get some more clarification on this statement. I do understand they are getting a payment token from which we are sending off to get the payment authorized. If they have the option to use a vaulted credit card how will the developer know which card to use? Is there a flag that allows them to access more than one card? I am confused about the vaulting process. 

 Does store credit cause any problems? What is that processes look like?

Limitations:
Public payments for orders created with Manual Discount: What is meant by a manual discount?
- Gift certificate: does this mean using a gift certificate with the order or buying a gift cert
